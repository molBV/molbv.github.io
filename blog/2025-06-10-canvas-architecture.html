<!doctype html><html lang="en"><head>
<meta charset="utf-8"><title>Canvas architecture & the game loop — Aviar Dev Blog</title>
<meta name="description" content="The final loop: input capture, timing, a compact spatial grid for collisions, and predictable draw order.">
<link rel="icon" href="/favicon.png" type="image/png"><link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/styles.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9879261118412366" crossorigin="anonymous"></script>
</head><body>
<header>
  <div class="logo">Aviar — Rocket Birdie</div>
  <div class="hamburger" id="burger">☰</div>
  <nav id="navLinks">
    <a href="/index.html">Play</a>
    <a href="/how-to-play.html">How to Play</a>
    <a href="/changelog.html">Changelog</a>
    <a href="/about.html">About</a>
    <a href="/blog/">Blog</a>
    <a href="/contact.html">Contact</a>
    <a href="/privacy.html">Privacy</a>
    <a href="/terms.html">Terms</a>
  </nav>
</header>
<main class="wrap article">
  <h1>Canvas architecture & the game loop</h1>
  <p class="small">June 10, 2025 • 7–8 min read</p>
  <h2>Input capture first</h2>
  <p>We sample input at the start of the frame to reduce perceived latency. That single change made flaps feel crisp at both 60fps and variable refresh.</p>
  <h2>Timing</h2>
  <p>Aviar uses <em>rAF</em> with a clamped <em>delta</em> and a simple accumulator where needed (e.g., physics stepping during spikes). We keep allocations off the hot path to avoid GC hiccups during bosses.</p>
  <h2>Collision</h2>
  <p>Instead of an overkill quadtree, a <em>compact spatial grid</em> partitions hazards/projectiles. It’s cache-friendly and predictable, which matters more than theoretical best-case in this genre.</p>
  <h2>Draw order</h2>
  <p>Background → hazards → player → FX → UI. Particles batch by layer to minimize state changes. Nothing fancy; just consistent.</p>
  <hr><p><a href="/blog/">← Back to blog</a></p>
</main>
<footer><div class="wrap small">© <span id="y"></span> Aviar • <a href="/privacy.html">Privacy</a> • <a href="/terms.html">Terms</a> • <a href="/ads.txt">ads.txt</a> • Built with help from ChatGPT</div></footer>
<script>document.getElementById('y').textContent=new Date().getFullYear()</script>
<script>
const burger=document.getElementById("burger");
const navLinks=document.getElementById("navLinks");
burger.addEventListener("click",()=>{navLinks.classList.toggle("open");});
</script>
</body></html>
